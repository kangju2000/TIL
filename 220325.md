# ğŸ“š 2022.03.25 ê³µë¶€

## Board í”„ë¡œì íŠ¸

### ì˜¤ëŠ˜ì˜ ê³ ë¯¼

#### ë¹„ë™ê¸° ì²˜ë¦¬ ë¬¸ì œ(ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ í•´ê²°í•¨)

> ë¡œê·¸ì¸ ì—¬ë¶€ì— ë”°ë¼ board í˜ì´ì§€ë¥¼ ë“¤ì–´ê°ˆ ìˆ˜ ìˆë‚˜ ì—†ë‚˜ë¥¼ í™•ì¸í•´ì£¼ëŠ” ì½”ë“œê°€ hoc/auth.js ì˜€ë‹¤.ê·¼ë° ë¡œê·¸ì¸ ì•ˆ í•œ ìƒíƒœì—ì„œ ë°”ë¡œ board í˜ì´ì§€ë¥¼ ë“¤ì–´ê°ˆ ë•Œ ì ê¹ í™”ë©´ì´ ë–´ë‹¤ê°€ navigateì— ì˜í•´ ë‹¤ì‹œ ë©”ì¸ í˜ì´ì§€ë¡œ ëŒì•„ì˜¨ë‹¤. ì´ëŸ¬í•œ ë¬¸ì œëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì œëŒ€ë¡œ ë˜ì§€ ì•Šì•„ ìƒê¸°ëŠ” ë¬¸ì œì´ë‹¤.

-   `Auth(BoardPage, true);` ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ useEffectì—ì„œ auth()ë¥¼ dispatchí•˜ëŠ”ë° ì´ê±¸ í•˜ê¸°ë„ ì „ì— BoardPageê°€ ë¦¬í„´ë˜ì„œ ì´ëŸ° ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.

    -   ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í•˜ë ¤ê³  async/await ë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ ì²˜ë¦¬ê°€ ì œëŒ€ë¡œ ë˜ì§€ì•Šì•„ ì¼ë‹¨ ë‹¤ë¥¸ ë°©ë²•ì„ ìƒê°í–ˆë‹¤.

        -   ì›ë˜ëŠ” ëª¨ë“  í˜ì´ì§€ë¥¼ ë“¤ì–´ê°ˆ ë•Œ hoc/auth.js ë¥¼ ë“¤ì–´ê°€ dispatchë¥¼ í•´ì¤˜ì„œ ê³„ì† ì—…ë°ì´íŠ¸ë¥¼ í•´ì£¼ì—ˆëŠ”ë‹¤.ì´ê±¸ ë©”ì¸í˜ì´ì§€ ë“¤ì–´ê°”ì„ ë•Œì—ë§Œ dispatch í•´ì£¼ê³ , useSelectorë¥¼ ì‚¬ìš©í•´ì„œ isAuthë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ì‹ìœ¼ë¡œ ë°”ê¾¸ì—ˆë‹¤.

        ```javascript
        // src/hoc/PrivateRoute.js

        import React from "react";
        import { Navigate } from "react-router-dom";
        import { useSelector } from "react-redux";

        export default function ({ children }) {
            const user = useSelector((state) => state.user.userData);
            const option = children.props.option;
            if (option)
                return user.isAuth ? children : <Navigate to="/login" />;
            // option true ì€ íšŒì›ë§Œ ì¶œì… ê°€ëŠ¥, ë¹„íšŒì›ì€ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
            else return user.isAuth ? <Navigate to="/board" /> : children;
            // option false ì€ ë¹„íšŒì›ë§Œ ì¶œì… ê°€ëŠ¥, íšŒì›ì´ ì¶œì…í•˜ë©´ ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™
        }
        ```

        -   ê·¸ë¦¬ê³  App.jsë¥¼ ìˆ˜ì •í–ˆë‹¤.

        ```javascript
        // src/App.js

        ...
        import { Route, Routes } from "react-router-dom";

        <Routes>
            <Route exact path="/" element={<LandingPage option={null} />} />
            <Route
                path="/login"
                element={
                    <PrivateRoute>
                        <LoginPage option={false} />
                    </PrivateRoute>
                }
            />
            <Route
                path="/register"
                element={
                    <PrivateRoute>
                        <RegisterPage option={false} />
                    </PrivateRoute>
                }
            />
            <Route
                path="/board"
                element={
                    <PrivateRoute>
                        <BoardPage option={true} />
                    </PrivateRoute>
                }
            />
        </Routes>;
        ```

#### ìƒˆë¡œê³ ì¹¨ ì‹œ Reduxì˜ ë°ì´í„°ê°€ ì‚¬ë¼ì§€ëŠ” ë¬¸ì œ

> useSelectorë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¬ ë•Œ ì˜¤ë¥˜ê°€ ìƒê¸´ë‹¤. êµ¬ê¸€ë§ í•´ë³´ë‹ˆ redux-persistë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤ê³  í•œë‹¤.

    -   redux-persistëŠ” localStorageë‚˜ sessionì„ í†µí•´ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ”ë°,
        1. localstageëŠ” ë”°ë¡œ ì œê±°í•´ì£¼ì§€ ì•ŠëŠ” ì´ìƒ ì˜êµ¬ì ìœ¼ë¡œ ì¡´ì¬
        2. sessionì€ ë¸Œë¼ìš°ì € íƒ­ì„ ë‹«ì•˜ì„ ë•Œ ë°ì´í„°ê°€ ì´ˆê¸°í™”

    ```javascript
    // src/\_reducers/index.js

    import { combineReducers } from "redux";
    import user from "./user_reducer";
    import { persistReducer } from "redux-persist";
    import storage from "redux-persist/lib/storage";

    const persistConfig = {
        key: "root",
        storage,
    };
    const rootReducer = combineReducers({
        user,
    });
    const persistedReducer = persistReducer(persistConfig, rootReducer);

    export default persistedReducer;
    ```

    ```javascript
    // src/index.js

    import React from "react";
    import ReactDOM from "react-dom";
    import App from "./App";
    import reportWebVitals from "./reportWebVitals";
    import GlobalStyle from "./styles/GlobalStyle";
    import { BrowserRouter } from "react-router-dom";
    import { Provider } from "react-redux";
    import { createStore, applyMiddleware } from "redux";
    import promiseMiddleware from "redux-promise";
    import ReduxThunk from "redux-thunk";
    import Reducer from "./_reducers";
    import { persistStore } from "redux-persist";
    import { PersistGate } from "redux-persist/integration/react";

    const createStoreWithMiddleware = applyMiddleware(
        promiseMiddleware,
        ReduxThunk
    )(createStore);

    const store = createStoreWithMiddleware(
        Reducer,
        window.__REDUX_DEVTOOLS_EXTENSION__ &&
            window.__REDUX_DEVTOOLS_EXTENSION__()
    );
    const persistor = persistStore(store);

    ReactDOM.render(
        <React.StrictMode>
            <Provider store={store}>
                <BrowserRouter basename={process.env.PUBLIC_URL}>
                    <PersistGate persistor={persistor}>
                        <GlobalStyle />
                        <App />
                    </PersistGate>
                </BrowserRouter>
            </Provider>
        </React.StrictMode>,
        document.getElementById("root")
    );

    reportWebVitals();
    ```
