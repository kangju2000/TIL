# ğŸ“š 2022.03.22 ê³µë¶€

## Board í”„ë¡œì íŠ¸

### Board ì•±ê³¼ Heroku ì—°ê²°

-   ê¸°ì¡´ì˜ í”„ë¡œì íŠ¸ì™€ heroku ì—°ê²°í•˜ë‹¤ê°€ ë¬¸ì œê°€ ìƒê²¼ë‹¤.

    1. í”„ë¡ì‹œ ë¬¸ì œ: ì›ë˜ëŠ” clientì˜ package.jsonì— proxy ì„¤ì •ì„ í–ˆì—ˆëŠ”ë° ì˜¤ë¥˜ê°€ ë‚˜ì„œ src í´ë”ì— setProxy.jsë¥¼ ìƒì„±í–ˆë‹¤.

    ```javascript
    // src/setProxy.js

    const { createProxyMiddleware } = require("http-proxy-middleware");

    module.exports = function (app) {
        app.use(
            createProxyMiddleware("/api", {
                target: "http://localhost:5000",
                changeOrigin: true,
            })
        );
    };
    ```

    2.  ë°°í¬ ë¬¸ì œ

        -   ë¡œì»¬ í™˜ê²½ì—ì„œ ë°°í¬í•˜ê¸°ìœ„í•´ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œ í›„ì— package.jsonì˜ "scripts" ì½”ë“œë¥¼ ìˆ˜ì •í–ˆë‹¤.

        ```javascript
        "scripts": {
        "start": "npm run server",
        "dev": "concurrently \"npm run server\" \"npm run client\"",
        "server": "cd server && nodemon index",
        "client": "cd board-app && npm start",
        "heroku-postbuild": "cd board-app && npm install && npm run build"
        }
        ```

    3.  ì—°ê²°ê¹Œì§€ëŠ” ë˜ì—ˆìœ¼ë‚˜ redirectì‹œ ì—°ê²°ì´ ì•ˆë˜ëŠ” ì˜¤ë¥˜ê°€ ìƒê²¼ë‹¤.

        -   server/index.js ì—ì„œ ì´ ì½”ë“œë¥¼ ì¶”ê°€í–ˆë‹¤.

        ```javascript
        // server/index.js

        app.use(express.static(path.join(__dirname, "../board-app/build")));

        app.get("*", function (req, res) {
            res.sendFile(path.join(__dirname, "../board-app/build/index.html"));
        });
        ```

        í•˜ì§€ë§Œ ì—¬ê¸°ì„œ ë˜ ë¬¸ì œê°€ ìƒê²¼ë‹¤.

    4.  ë°°í¬ê¹Œì§€ ë˜ì—ˆëŠ”ë° ë¡œê·¸ì¸ì„ ìœ„í•´ ë§Œë“  reduxì—ì„œ ì˜¤ë¥˜ê°€ ë‚¬ë‹¤.

        -   ìœ ì €ì˜ ì •ë³´ê°€ ë‹´ê¸´ auth_userì˜ payload ì•ˆì— build/index.html ë‚´ìš©ì´ ë“¤ì–´ê°€ë²„ë ¸ë‹¤.
        -   ì¼ë‹¨ LandingPageë¥¼ ì ‘ì†í–ˆì„ë•Œ ê³¼ì •ì„ ë³´ìë©´

            1. Auth(LandingPage, null) ì—ì„œ AuthëŠ” hoc/auth.jsì´ë‹¤.
            2. ì—¬ê¸°ì—ì„œ auth()ë¥¼ dispatchí•´ì¤˜ì„œ ì´ ìœ ì €ê°€ ë¡œê·¸ì¸ì„ í–ˆëŠ”ì§€ ì•ˆ í–ˆëŠ”ì§€ í™•ì¸í•œë‹¤.
            3. auth()ëŠ” \_actions/user_action.js ì•ˆì— ìˆë‹¤. `axios.get("/api/users/auth")`ë¥¼ payloadë¡œ ë°›ê³  ìˆë‹¤.

        -   ì ‘ì†í•  ë•Œ ë¬´ì¡°ê±´ api/users/auth ë¥¼ ê±°ì¹˜ëŠ”ë° ì—¬ê¸°ì— ê°€ë©´ ë‚´ê°€ ë”°ë¡œ ë¼ìš°íŠ¸ë¥¼ í•œ ê³³ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— build/index.htmlì„ ë³´ë‚´ì£¼ëŠ”ë° ì´ê²Œ payloadë¡œ ë“¤ì–´ê°€ëŠ” ë“¯ í•˜ë‹¤.

        -   ê·¸ë˜ì„œ ì¼ë‹¨ ì„ì‹œë°©í¸ìœ¼ë¡œ ì´ë ‡ê²Œ í•´ë‘ì—ˆë‹¤.

        ```javascript
        app.get("/", function (req, res) {
            res.sendFile(path.join(__dirname, "../board-app/build/index.html"));
        });
        app.get("/board", function (req, res) {
            res.sendFile(path.join(__dirname, "../board-app/build/index.html"));
        });
        app.get("/register", function (req, res) {
            res.sendFile(path.join(__dirname, "../board-app/build/index.html"));
        });
        app.get("/login", function (req, res) {
            res.sendFile(path.join(__dirname, "../board-app/build/index.html"));
        });
        ```
